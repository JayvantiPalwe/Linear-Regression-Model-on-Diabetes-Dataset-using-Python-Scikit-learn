# -*- coding: utf-8 -*-
"""Copy of ML.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1jAKj6bIMLo3Q7AJP0AoBCZv-mAKG3taM
"""

from sklearn.datasets import load_diabetes
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import matplotlib.pyplot as plt
import numpy as np

# Load the diabetes dataset
diabetes = load_diabetes()

X, y = diabetes.data, diabetes.target

# Split the data into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Create a Linear Regression model
model = LinearRegression()

# Train the model
model.fit(X_train, y_train)

# Make predictions on the test set
y_pred = model.predict(X_test)

print("Target values model predicted:", y_pred)

# Evaluate the model
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)

print(f"Mean Squared Error: {mse:.2f}")
print(f"R-squared: {r2:.2f}")
print(f"Mean Absolute Error: {mae:.2f}")

# You can also print the coefficients and intercept
print("Coefficients:", model.coef_)
print("Intercept:", model.intercept_)

plt.figure(figsize=(10, 6))
plt.scatter(y_test, y_pred)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'k--', lw=2)
plt.xlabel("Actual")
plt.ylabel("Predicted")
plt.title("Actual vs. Predicted Values")
plt.grid(True)
plt.show()

# Section for user input and prediction
print("\n--- Make a prediction ---")
# The diabetes dataset has 10 features: age, sex, bmi, bp, s1, s2, s3, s4, s5, s6
# These values are already scaled.
# You can provide your own scaled input values here.
# Example input: np.array([[0.01, -0.04, 0.05, 0.02, -0.03, -0.02, -0.04, -0.00, 0.02, -0.01]])
# You need to provide a 2D array, even for a single sample.
user_input = np.array([[0.038076,	0.050680,	0.061696,	0.021872,	-0.044223,	-0.034821,	-0.043401,	-0.002592,	0.019907,	-0.017646]]) # Replace with your desired input

# Ensure the input has the correct shape (1, 10) for a single sample
if user_input.shape == (1, 10):
    # Make a prediction
    user_prediction = model.predict(user_input)
    print(f"Prediction for your input: {user_prediction[0]:.2f}")
else:
    print("Invalid input shape. Please provide a 2D array of shape (1, 10).")